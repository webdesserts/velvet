set nocompatible
set shell=/bin/sh

let g:velvet = {}

if has('win32') || has('win16')
  let g:velvet.vimfiles = "vimfiles"
  let g:velvet.vimrc = "_vimrc"
else
  let g:velvet.vimfiles = ".vim"
  let g:velvet.vimrc = ".vimrc"
end

" Find shit
let g:velvet.rc = fnamemodify(resolve(expand('<sfile>:p')), ':p:~')
let g:velvet.local = simplify(g:velvet.rc .'/../')
let g:velvet.root = simplify(g:velvet.local .'/../')
let g:velvet.config = g:velvet.local ."config.vim"
let g:velvet.plugins = g:velvet.local ."plugins.vim"
let g:velvet.settings = g:velvet.local .'settings/'
let g:velvet.packages = g:velvet.local .'packages/'
let g:velvet.plug = g:velvet.packages .'vim-plug/'

" Source that shit
exe 'source' g:velvet.config
exe 'source' g:velvet.plugins

let settings_files = split(globpath(g:velvet.settings, '*.vim'), '\n')

for file in settings_files
    exe 'source' file
endfor

cd %:p:h
